schema: '2.0'
stages:
  clip_forest_mask:
    cmd: python src/data/clip_forest_mask.py
    deps:
    - path: ./data/raw/sentinel-2/fca_grid_empty_raster_R20m.tif
      hash: md5
      md5: d7fb8f49333c197f99b8291e63c91c59
      size: 12774150
    - path: 
        /mnt/FS_data/geosense_data_registry/raw/masks/forest_type_2018/FTY_2018_010m_eu_03035_v010/DATA/FTY_2018_010m_eu_03035_V1_0.tif
      hash: md5
      md5: 67f7a74aad44a1e3ef0d1a8792528826
      size: 6111365885
    - path: src/data/clip_forest_mask.py
      hash: md5
      md5: 0777c4e43f935ae673add550d057e880
      size: 1470
    outs:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped.tif
      hash: md5
      md5: a264c8d81cdbd5b2d35f0126f82c54a6
      size: 5715285080
  reproject_forest_mask:
    cmd: python src/data/reproject_forest_mask.py
    deps:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped.tif
      hash: md5
      md5: 6f540ef4d80e3fdb440d74da9e1004ae
      size: 121461208
    - path: ./data/raw/sentinel-2/fca_grid_empty_raster_R20m.tif
      hash: md5
      md5: d7fb8f49333c197f99b8291e63c91c59
      size: 12774150
    - path: src/data/reproject_forest_mask.py
      hash: md5
      md5: cdaee470990fd83a4edac0082f7a9a4a
      size: 1422
    outs:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped_EPSG32632.tif
      hash: md5
      md5: 0c56b54e57efbe07a7ff3f53d4633c72
      size: 119244620
  clip_and_binarize_forest_mask:
    cmd: python src/data/clip_binarize_forest_mask.py
    deps:
    - path: ./data/raw/sentinel-2/fca_grid_empty_raster_R20m.tif
      hash: md5
      md5: d7fb8f49333c197f99b8291e63c91c59
      size: 12774150
    - path: 
        /mnt/FS_data/geosense_data_registry/raw/masks/forest_type_2018/FTY_2018_010m_eu_03035_v010/DATA/FTY_2018_010m_eu_03035_V1_0.tif
      hash: md5
      md5: 67f7a74aad44a1e3ef0d1a8792528826
      size: 6111365885
    - path: src/data/clip_binarize_forest_mask.py
      hash: md5
      md5: 260598bb11f61c9b314210262cb85ea8
      size: 1874
    outs:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped.tif
      hash: md5
      md5: 6f540ef4d80e3fdb440d74da9e1004ae
      size: 121461208
  polygonize_forest_mask:
    cmd: python src/data/polygonize_forest_mask.py
    deps:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped_EPSG32632.tif
      hash: md5
      md5: dac468e1770609b81a9dfc69e73a4aee
      size: 122273754
    - path: src/data/polygonize_forest_mask.py
      hash: md5
      md5: 4102ad9f6d122863a0789f30efceaa76
      size: 3833
    outs:
    - path: ./data/interim/forest_mask/forest_mask.gpkg
      hash: md5
      md5: ce65136ec33b4cb4283d540dcde134f2
      size: 2208034816
  clip_gbif:
    cmd: python src/data/clip_gbif.py
    deps:
    - path: ./data/raw/sentinel-2/fca_grid_empty_raster_R20m.tif
      hash: md5
      md5: d7fb8f49333c197f99b8291e63c91c59
      size: 12774150
    - path: 
        /mnt/FS_data/geosense_data_registry/raw/gbif/all_tracheophyta_non-cult_2024-01-21/all_tracheophyta_non-cult_2024-01-21.parquet
      hash: md5
      md5: 08a894c291d8087e1223922601ad551e.dir
      size: 28197369171
      nfiles: 1482
    - path: src/data/clip_gbif.py
      hash: md5
      md5: 6451c390a3c695c06edaf545b8b312cb
      size: 2888
    outs:
    - path: ./data/interim/gbif/gbif_clipped.parquet
      hash: md5
      md5: f33d25fa69644786802376150b00297d
      size: 179811145
  mask_gbif:
    cmd: python src/data/mask_gbif.py
    deps:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped_EPSG32632.tif
      hash: md5
      md5: d65de3f24c842d2549e2836d609a176a
      size: 118857655
    - path: ./data/interim/gbif/gbif_clipped.parquet
      hash: md5
      md5: f33d25fa69644786802376150b00297d
      size: 179811145
    - path: src/data/mask_gbif.py
      hash: md5
      md5: 91b0f3344154426e668b8a3259b39992
      size: 1578
    outs:
    - path: ./data/interim/gbif/gbif_masked.parquet
      hash: md5
      md5: 3573080903601f48b8374b58ebeda5dd
      size: 57948014
  setup_forest_mask:
    cmd: python src/data/setup_forest_mask.py
    deps:
    - path: ./data/raw/sentinel-2/fca_grid_empty_raster_R10m.tif
      hash: md5
      md5: 525de44faa75dc7be138ee11c0d2463c
      size: 37282312
    - path: 
        /mnt/FS_data/geosense_data_registry/raw/masks/forest_type_2018/FTY_2018_010m_eu_03035_v010/DATA/FTY_2018_010m_eu_03035_V1_0.tif
      hash: md5
      md5: 67f7a74aad44a1e3ef0d1a8792528826
      size: 6111365885
    - path: src/data/setup_forest_mask.py
      hash: md5
      md5: 8468edcca5e642af594541ecdf84b7b5
      size: 1983
    outs:
    - path: ./data/interim/forest_mask/FTY_2018_010m_eu_03035_V1_0_clipped_EPSG32632.tif
      hash: md5
      md5: d65de3f24c842d2549e2836d609a176a
      size: 118857655
  save_species_ids_points:
    cmd: python src/data/save_gbif_points.py
    deps:
    - path: ./data/interim/gbif/gbif_masked.parquet
      hash: md5
      md5: 3573080903601f48b8374b58ebeda5dd
      size: 57948014
    - path: src/data/save_gbif_points.py
      hash: md5
      md5: acc6ec512603db602ad2199bf8567aad
      size: 1255
    outs:
    - path: ./data/interim/gbif/points.parquet
      hash: md5
      md5: 2a0aaef66885dee61ab69801481b8b8d
      size: 120808721
    - path: ./data/interim/gbif/species_ids.parquet
      hash: md5
      md5: a8974e4b3ef96b906e6b44c48f6e1587
      size: 171818
